
<div class="eventos-container">
  <h2 class="titulo-seccion">PrÃ³ximos Eventos</h2>
  
 
  <div class="filtros-container">
    <form [formGroup]="filtrosForm">
      <div class="filtros-grid">
       
        <div class="filtro-item">
          <label for="filtroNombre">ğŸ” Buscar por nombre o lugar</label>
          <input 
            type="text" 
            id="filtroNombre"
            formControlName="nombre"
            placeholder="Ej: Concierto, Teatro..."
            class="filtro-input"
          />
        </div>

        
        <div class="filtro-item">
          <label for="filtroFecha">ğŸ“… Filtrar por fecha</label>
          <input 
            type="date" 
            id="filtroFecha"
            formControlName="fecha"
            class="filtro-input"
          />
        </div>

        
        <div class="filtro-item">
          <label for="filtroCategoria">ğŸ­ CategorÃ­a</label>
          <select 
            id="filtroCategoria"
            formControlName="categoria"
            class="filtro-input"
          >
            <option value="">Todas las categorÃ­as</option>
            @for (categoria of categorias; track categoria) {
              <option [value]="categoria">{{ categoria }}</option>
            }
          </select>
        </div>
      </div>
    </form>

    
    <div class="filtros-acciones">
      <button (click)="limpiarFiltros()" class="btn-limpiar">
        ğŸ—‘ï¸ Limpiar Filtros
      </button>
      <span class="resultados-contador">
        {{ eventosFiltrados().length }} evento(s) encontrado(s)
      </span>
    </div>
  </div>
  
  @if (isLoading()) {
    <div class="loading">
      <div class="spinner"></div>
      <p>Cargando eventos...</p>
    </div>
  } @else if (eventosFiltrados().length > 0) {
    <div class="eventos-grid">
      @for (evento of eventosFiltrados(); track evento.id) {

        <div class="evento-card" (click)="verDetalleEvento(evento.id)">
          
          @if (usuario() && usuario().rol === 'usuario') {
            <button 
              class="btn-favorito" 
              [class.activo]="esFavorito(evento.id)"
              (click)="toggleFavorito(evento, $event)"
              [title]="esFavorito(evento.id) ? 'Quitar de favoritos' : 'Agregar a favoritos'">
              {{ esFavorito(evento.id) ? 'â¤ï¸' : 'ğŸ¤' }}
            </button>
          }
          
          <div class="evento-imagen">
            @if (evento.imagen) {
              <img [src]="evento.imagen" [alt]="evento.titulo">
            } @else {
              <div class="sin-imagen">Sin imagen</div>
            }
            @if (evento.categoria) {
              <span class="categoria-badge">{{ evento.categoria }}</span>
            }
          </div>
          <div class="evento-info">
            <h3>{{ evento.titulo }}</h3>
            <div class="evento-detalles">
              <p><span class="icono">ğŸ“…</span> {{ evento.fecha | date:'dd/MM/yyyy' }}</p>
              <p><span class="icono">ğŸ•</span> {{ evento.hora }}</p>
              <p><span class="icono">ğŸ“</span> {{ evento.lugar }}</p>
            </div>
            @if(usuario() && usuario().rol === 'usuario') {
               <button class="btn-ver-mas">Comprar â†’</button>
            }@else if (usuario() && usuario().rol === 'admin' || !usuario()) {
            <button class="btn-ver-mas">Ver Detalles â†’</button>
            }
          </div>
        </div>
      }
    </div>
  } @else {
    <div class="sin-eventos">
      <p>ğŸ“­ No se encontraron eventos con los filtros aplicados</p>
      <p>Intenta ajustar los criterios de bÃºsqueda</p>
      <button (click)="limpiarFiltros()" class="btn-limpiar-inline">
        Limpiar Filtros
      </button>
    </div>
  }
</div>